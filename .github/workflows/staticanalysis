name: CI Test

# Controls when the action will run. 
on:
  # Triggers the workflow on push or pull request events but only for the master branch
  push:
    branches: [ master ]
  pull_request:
    #branches: [ master ]

jobs:
  Static-Check:
    name: Static-Code-Analysis
    runs-on: ubuntu-latest
    env: xNEST_BUILD_TYPE=STATIC_CODE_ANALYSIS
    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: actions/checkout@v2

      - name: Setup Python
        uses: actions/setup-python@v1
        with:
          python-version: 3.8
      
      #- name: Install dependencies with pipenv
      #  run: |
      #    pip install pipenv
      #    pipenv install --deploy --dev
      #- run: pipenv run mypy
      
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip setuptools
          python -m pip install scipy junitparser mpi4py numpy nose cython matplotlib terminaltables
          pip list
          g++ --version
          chmod +x extras/travis_build.sh
          set -o pipefail
          ./extras/travis_build.sh 2>&1 | tee travis_build.sh.log
